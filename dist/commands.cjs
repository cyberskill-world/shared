#!/usr/bin/env node
"use strict";function e(e,t){if(t==null||t>e.length)t=e.length;for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function t(t){if(Array.isArray(t))return e(t)}function n(e,t,n,r,s,c,a){try{var i=e[c](a);var o=i.value}catch(e){n(e);return}if(i.done){t(o)}else{Promise.resolve(o).then(r,s)}}function r(e){return function(){var t=this,r=arguments;return new Promise(function(s,c){var a=e.apply(t,r);function i(e){n(a,s,c,i,o,"next",e)}function o(e){n(a,s,c,i,o,"throw",e)}i(undefined)})}}function s(e,t,n){if(t in e){Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true})}else{e[t]=n}return e}function c(e){if(typeof Symbol!=="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};var r=Object.keys(n);if(typeof Object.getOwnPropertySymbols==="function"){r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))}r.forEach(function(t){s(e,t,n[t])})}return e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);if(t){r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})}n.push.apply(n,r)}return n}function u(e,t){t=t!=null?t:{};if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(t))}else{o(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function l(e){return t(e)||c(e)||p(e)||a()}function f(e){"@swc/helpers - typeof";return e&&typeof Symbol!=="undefined"&&e.constructor===Symbol?"symbol":typeof e}function p(t,n){if(!t)return;if(typeof t==="string")return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor)r=t.constructor.name;if(r==="Map"||r==="Set")return Array.from(r);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(t,n)}function h(e,t){var n,r,s,c,a={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]};return c={next:i(0),"throw":i(1),"return":i(2)},typeof Symbol==="function"&&(c[Symbol.iterator]=function(){return this}),c;function i(e){return function(t){return o([e,t])}}function o(c){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(s=c[0]&2?r["return"]:c[0]?r["throw"]||((s=r["return"])&&s.call(r),0):r.next)&&!(s=s.call(r,c[1])).done)return s;if(r=0,s)c=[c[0]&2,s.value];switch(c[0]){case 0:case 1:s=c;break;case 4:a.label++;return{value:c[1],done:false};case 5:a.label++;r=c[1];c=[0];continue;case 7:c=a.ops.pop();a.trys.pop();continue;default:if(!(s=a.trys,s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){a.label=c[1];break}if(c[0]===6&&a.label<s[1]){a.label=s[1];s=c;break}if(s&&a.label<s[2]){a.label=s[2];a.ops.push(c);break}if(s[2])a.ops.pop();a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e];r=0}finally{n=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:true}}}var d=Object.create;var g=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var m=Object.getOwnPropertyNames;var v=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty;var _=function(e,t,n,r){var s=true,c=false,a=undefined;if(t&&(typeof t==="undefined"?"undefined":f(t))=="object"||typeof t=="function")try{var i=function(){var s=u.value;!b.call(e,s)&&s!==n&&g(e,s,{get:function(){return t[s]},enumerable:!(r=y(t,s))||r.enumerable})};for(var o=m(t)[Symbol.iterator](),u;!(s=(u=o.next()).done);s=true)i()}catch(e){c=true;a=e}finally{try{if(!s&&o.return!=null){o.return()}}finally{if(c){throw a}}}return e};var w=function(e,t,n){return n=e!=null?d(v(e)):{},_(t||!e||!e.__esModule?g(n,"default",{value:e,enumerable:!0}):n,e)};var I=function(){return(typeof document==="undefined"?"undefined":f(document))>"u"?new URL("file:".concat(__filename)).href:document.currentScript&&document.currentScript.src||new URL("main.js",document.baseURI).href},S=I();var O=w(require("fs"),1),T=w(require("path"),1),E=w(require("process"),1),P=require("yargs/helpers"),k=w(require("yargs/yargs"),1);var C=require("path"),N=require("url"),A=(0,N.fileURLToPath)(S),j=(0,C.dirname)(A);var x=w(require("localforage"),1),D=w(require("node-persist"),1),R=w(require("os"),1),M=w(require("path"),1),G=w(require("process"),1),W=(typeof window==="undefined"?"undefined":f(window))<"u",q=G.default.env.CYBERSKILL_STORAGE_DIR||M.default.join(R.default.homedir(),".cyberskill-storage");function U(){return H.apply(this,arguments)}function H(){H=r(function(){var e;return h(this,function(t){switch(t.label){case 0:e=!W&&!D.default.defaultInstance;if(!e)return[3,2];return[4,D.default.init({dir:q,stringify:JSON.stringify,parse:JSON.parse,encoding:"utf8",logging:!1,forgiveParseErrors:!0})];case 1:e=t.sent();t.label=2;case 2:e;return[2]}})});return H.apply(this,arguments)}var F={get:function e(e){return r(function(){var t,n,r;return h(this,function(s){switch(s.label){case 0:s.trys.push([0,6,,7]);if(!W)return[3,2];return[4,x.default.getItem(e)];case 1:n=s.sent();return[3,5];case 2:return[4,U()];case 3:s.sent();return[4,D.default.getItem(e)];case 4:n=(t=s.sent())!==null&&t!==void 0?t:null;s.label=5;case 5:return[2,n];case 6:r=s.sent();return[2,(console.error('❌ [Storage:get] Error getting key "'.concat(e,'":'),r),null)];case 7:return[2]}})})()},set:function e(e,t){return r(function(){var n,r;return h(this,function(s){switch(s.label){case 0:s.trys.push([0,6,,7]);if(!W)return[3,2];return[4,x.default.setItem(e,t)];case 1:n=s.sent();return[3,5];case 2:return[4,U()];case 3:s.sent();return[4,D.default.setItem(e,t)];case 4:n=s.sent();s.label=5;case 5:n;return[3,7];case 6:r=s.sent();console.error('❌ [Storage:set] Error setting key "'.concat(e,'":'),r);return[3,7];case 7:return[2]}})})()},remove:function e(e){return r(function(){var t,n;return h(this,function(r){switch(r.label){case 0:r.trys.push([0,6,,7]);if(!W)return[3,2];return[4,x.default.removeItem(e)];case 1:t=r.sent();return[3,5];case 2:return[4,U()];case 3:r.sent();return[4,D.default.removeItem(e)];case 4:t=r.sent();r.label=5;case 5:t;return[3,7];case 6:n=r.sent();console.error('❌ [Storage:remove] Error removing key "'.concat(e,'":'),n);return[3,7];case 7:return[2]}})})()},keys:function e(){return r(function(){var e,t;return h(this,function(n){switch(n.label){case 0:n.trys.push([0,6,,7]);if(!W)return[3,2];return[4,x.default.keys()];case 1:e=n.sent();return[3,5];case 2:return[4,U()];case 3:n.sent();return[4,D.default.keys()];case 4:e=n.sent()||[];n.label=5;case 5:return[2,e];case 6:t=n.sent();return[2,(console.error("❌ [Storage:keys] Error getting keys:",t),[])];case 7:return[2]}})})()},values:function e(){return r(function(){var e,t;return h(this,function(n){switch(n.label){case 0:n.trys.push([0,7,,8]);if(!W)return[3,3];return[4,x.default.keys()];case 1:e=n.sent();return[4,Promise.all(e.map(function(e){return x.default.getItem(e)}))];case 2:return[2,n.sent().filter(function(e){return e!==null})];case 3:return[4,U()];case 4:n.sent();return[4,D.default.values()];case 5:return[2,n.sent()];case 6:return[3,8];case 7:t=n.sent();return[2,(console.error("❌ [Storage:values] Error getting values:",t),[])];case 8:return[2]}})})()},entries:function e(){return r(function(){var e,t,n,s;return h(this,function(c){switch(c.label){case 0:c.trys.push([0,8,,9]);if(!W)return[3,3];return[4,x.default.keys()];case 1:e=c.sent();return[4,Promise.all(e.map(/*#__PURE__*/function(){var e=r(function(e){var t;return h(this,function(n){switch(n.label){case 0:return[4,x.default.getItem(e)];case 1:t=n.sent();return[2,t!==null?[e,t]:null]}})});return function(t){return e.apply(this,arguments)}}()))];case 2:return[2,c.sent().filter(function(e){return e!==null})];case 3:return[4,U()];case 4:c.sent();return[4,D.default.keys()];case 5:t=c.sent();return[4,D.default.values()];case 6:n=c.sent();return[2,t.map(function(e,t){return[e,n[t]]})];case 7:return[3,9];case 8:s=c.sent();return[2,(console.error("❌ [Storage:entries] Error getting entries:",s),[])];case 9:return[2]}})})()},clear:function e(){return r(function(){var e,t;return h(this,function(n){switch(n.label){case 0:n.trys.push([0,6,,7]);if(!W)return[3,2];return[4,x.default.clear()];case 1:e=n.sent();return[3,5];case 2:return[4,U()];case 3:n.sent();return[4,D.default.clear()];case 4:e=n.sent();n.label=5;case 5:e;return[3,7];case 6:t=n.sent();console.error("❌ [Storage:clear] Error clearing storage:",t);return[3,7];case 7:return[2]}})})()},length:function e(){return r(function(){var e,t;return h(this,function(n){switch(n.label){case 0:n.trys.push([0,6,,7]);if(!W)return[3,2];return[4,x.default.length()];case 1:e=n.sent();return[3,5];case 2:return[4,U()];case 3:n.sent();return[4,D.default.keys()];case 4:e=n.sent().length;n.label=5;case 5:return[2,e];case 6:t=n.sent();return[2,(console.error("❌ [Storage:length] Error getting storage length:",t),0)];case 7:return[2]}})})()}};var K=function(e){return"error_list:".concat(e)},L=24*60*60*1e3;function J(e){return B.apply(this,arguments)}function B(){B=r(function(e){var t,n,r;return h(this,function(s){switch(s.label){case 0:if(!e.length)return[2];t=Date.now(),n=K(t);s.label=1;case 1:s.trys.push([1,3,,4]);return[4,F.set(n,{errors:e,timestamp:t})];case 2:s.sent(),console.log("✅ Saved ".concat(e.length," errors to storage with key: ").concat(n));return[3,4];case 3:r=s.sent();console.error("❌ Failed to save errors: ".concat(r.message));return[3,4];case 4:return[2]}})});return B.apply(this,arguments)}function Y(){return $.apply(this,arguments)}function $(){$=r(function(){var e,t,n,r,s,c,a,i,o,u,f,p;return h(this,function(h){switch(h.label){case 0:h.trys.push([0,10,,11]);return[4,F.keys()];case 1:e=h.sent().filter(function(e){return e.startsWith("error_list:")}),t=[];n=true,r=false,s=undefined;h.label=2;case 2:h.trys.push([2,7,8,9]);c=e[Symbol.iterator]();h.label=3;case 3:if(!!(n=(a=c.next()).done))return[3,6];i=a.value;return[4,F.get(i)];case 4:u=h.sent();u&&(o=t).push.apply(o,l(u.errors));h.label=5;case 5:n=true;return[3,3];case 6:return[3,9];case 7:f=h.sent();r=true;s=f;return[3,9];case 8:try{if(!n&&c.return!=null){c.return()}}finally{if(r){throw s}}return[7];case 9:return[2,t];case 10:p=h.sent();return[2,(console.error("❌ Failed to retrieve stored errors: ".concat(p.message)),[])];case 11:return[2]}})});return $.apply(this,arguments)}var z=w(require("boxen"),1),Q=w(require("chalk"),1);var V=Q.default,X=V.blue,Z=V.red,ee=V.yellow,et=V.green,en=V.gray,er=V.bold;function es(e,t){var n=new Map([[Z,"red"],[ee,"yellow"],[et,"green"]]).get(t)||"green";return(0,z.default)(er(t(e)),{padding:1,margin:1,borderStyle:"arrow",borderColor:n})}function ec(e,t,n,r){e.length&&(e.forEach(function(e){var r=e.file,s=e.position,c=e.rule,a=e.message;console.log("".concat(t("".concat(n," File:"))," ").concat(X("".concat(r).concat(s?":".concat(s):"")))),c&&console.log("   ".concat(t("Rule:")," ").concat(t(c))),console.log("   ".concat(t("Message:")," ").concat(t(a)))}),console.log(es(er(t("".concat(n," Total ").concat(r,": ").concat(e.length))),t)),console.log(en("─".repeat(40))))}function ea(){return ei.apply(this,arguments)}function ei(){ei=r(function(){var e,t;return h(this,function(n){switch(n.label){case 0:return[4,Y()];case 1:e=n.sent().filter(function(e){return e.type==="error"});return[4,Y()];case 2:t=n.sent().filter(function(e){return e.type==="warning"});!e.length&&!t.length?console.log(es(er(et("✔ NO ISSUE FOUND!")),et)):(ec(t,ee,"⚠","Warnings"),ec(e,Z,"✖","Errors"));return[2]}})});return ei.apply(this,arguments)}var eo=w(require("process"),1),eu=w(require("ora"),1);function el(e,t){return ef.apply(this,arguments)}function ef(){ef=r(function(e,t){var n,r,s,c,a,i,o,u,l;var f=arguments;return h(this,function(p){switch(p.label){case 0:n=f.length>2&&f[2]!==void 0?f[2]:{};r=n.successMessage,s=n.failureMessage,c=n.errorList,a=c===void 0?[]:c,i=n.exitOnError,o=i===void 0?!0:i,u=(0,eu.default)({text:e,color:"cyan",spinner:"dots"}).start();p.label=1;case 1:p.trys.push([1,3,,4]);return[4,t()];case 2:p.sent(),a.length?o?(u.fail(s||"".concat(e," ❌")),eo.default.exit(1)):u.fail(s||"".concat(e," ❌")):u.succeed(r||"".concat(e," ✅"));return[3,4];case 3:l=p.sent();if(u.fail(s||"".concat(e," ❌")),o)eo.default.exit(1);else throw l;return[3,4];case 4:return[2]}})});return ef.apply(this,arguments)}var ep=w(require("chalk"),1),eh=require("child_process"),ed=w(require("process"),1),eg=w(require("util"),1);var ey=eg.promisify(eh.exec),em=ep.default,ev=em.gray,eb=em.white,e_=[];function ew(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";var n=new Date().toLocaleString();console.log("".concat(t," [").concat(n,"] ").concat(eb(e)))}function eI(e){var t=/^\s*(\d+):(\d+)\s+(error|warning)\s+(\S+)\s+(\S+)$/,n=/^(.+?)\((\d+),(\d+)\):\s+(error|warning)\s+TS\d+:\s+(\S.+)$/,r=/^✖\s+(.*?)\s+\[(.*?)\]$/,s=[],c="";e.split("\n").forEach(function(e){if(e.startsWith("/"))c=e.trim();else{var a=t.exec(e);if(a&&c)e_.push({file:c,position:"".concat(a[1],":").concat(a[2]),type:a[3]==="error"?"error":"warning",message:a[4].trim(),rule:a[5].trim()});else{var i=n.exec(e);if(i)e_.push({file:i[1],position:"".concat(i[2],":").concat(i[3]),type:i[4],message:i[5].trim()});else{var o=r.exec(e);o?e_.push({file:"commitlint",type:"error",message:o[1].trim(),rule:o[2].trim()}):s.push(e.trim())}}}}),s.length>0&&(console.log(ev("Unmatched lines:")),s.forEach(function(e){return console.info(e)}))}function eS(e){try{JSON.parse(e).forEach(function(e){var t=e.filePath,n=e.messages;n.forEach(function(e){var n=e.severity,r=e.line,s=e.column,c=e.ruleId,a=e.message;e_.push({type:n===2?"error":"warning",file:t,position:"".concat(r,":").concat(s),rule:c,message:a})})})}catch(t){eI(e)}}function eO(e,t){return eT.apply(this,arguments)}function eT(){eT=r(function(e,t){var n,r,s,c,a,i,o;var u=arguments;return h(this,function(l){switch(l.label){case 0:n=u.length>2&&u[2]!==void 0?u[2]:eS;ew(t);r=new AbortController;ed.default.on("SIGINT",function(){console.log("Terminating process..."),r.abort(),ed.default.exit()});l.label=1;case 1:l.trys.push([1,5,,6]);return[4,ey(e,{maxBuffer:0x6400000,signal:r.signal})];case 2:s=l.sent(),c=s.stdout,a=s.stderr;[c,a].forEach(function(e){return e&&n(e)});i=e_.length;if(!i)return[3,4];return[4,J(e_)];case 3:i=l.sent();l.label=4;case 4:i;return[3,6];case 5:o=l.sent();console.error("Command failed: ".concat(o.message));return[3,6];case 6:return[2]}})});return eT.apply(this,arguments)}var eE=w(require("node-fetch"),1),eP=w(require("fs"),1),ek=w(require("path"),1),eC=w(require("process"),1);var eN=24*60*60*1e3;function eA(e){return ej.apply(this,arguments)}function ej(){ej=r(function(e){var t,n,r,s,c,a,i,o,u,l;var f=arguments;return h(this,function(p){switch(p.label){case 0:t=f.length>1&&f[1]!==void 0?f[1]:!1;n="npm_version:".concat(e),r="npm_metadata:".concat(e);return[4,F.get(n)];case 1:s=p.sent();return[4,F.get(r)];case 2:c=p.sent(),a=s&&Date.now()-s.timestamp<eN;if(!t&&a)return[2,(console.log("Using cached version for ".concat(e,": ").concat(s.version)),s.version)];i={};(c===null||c===void 0?void 0:c.etag)&&(i["If-None-Match"]=c.etag),(c===null||c===void 0?void 0:c.lastModified)&&(i["If-Modified-Since"]=c.lastModified);p.label=3;case 3:p.trys.push([3,8,,9]);console.log("Fetching latest version for ".concat(e,"..."));return[4,(0,eE.default)("https://registry.npmjs.org/".concat(e,"/latest"),{headers:i})];case 4:o=p.sent();if(o.status===304&&s)return[2,(console.log("Cache is still valid for ".concat(e,": ").concat(s.version)),s.version)];if(!o.ok)throw new Error("Failed to fetch latest version: ".concat(o.statusText));return[4,o.json()];case 5:u=p.sent().version;return[4,F.set(n,{version:u,timestamp:Date.now()})];case 6:p.sent();return[4,F.set(r,{etag:o.headers.get("ETag")||void 0,lastModified:o.headers.get("Last-Modified")||void 0})];case 7:return[2,(p.sent(),console.log("Cached latest version for ".concat(e,": ").concat(u)),u)];case 8:l=p.sent();if(console.error("Error fetching latest version for ".concat(e,": ").concat(l.message)),s)return[2,(console.warn("Falling back to cached version for ".concat(e,": ").concat(s.version)),s.version)];throw l;case 9:return[2]}})});return ej.apply(this,arguments)}function ex(e,t){try{var n=ek.default.join(e,"package.json");return eP.default.existsSync(n)?JSON.parse(eP.default.readFileSync(n,"utf-8")).name===t:!1}catch(e){return console.error("Error reading package.json: ".concat(e.message)),!1}}var eD={INIT_CWD:E.default.env.INIT_CWD||E.default.cwd(),TS_CONFIG_PATH:"".concat(E.default.env.INIT_CWD||E.default.cwd(),"/tsconfig.json"),LINT_STAGED_CONFIG_PATH:"".concat(E.default.env.INIT_CWD||E.default.cwd(),"/lint-staged.config.js"),HUSKY_PATH:"".concat(E.default.env.INIT_CWD||E.default.cwd(),"/.husky"),GIT_HOOK_PATH:"".concat(E.default.env.INIT_CWD||E.default.cwd(),"/.git/hooks"),GIT_COMMIT_MSG:"".concat(E.default.env.INIT_CWD||E.default.cwd(),"/.git/COMMIT_EDITMSG"),SIMPLE_GIT_HOOKS_PATH:"".concat(E.default.env.INIT_CWD||E.default.cwd(),"/.simple-git-hooks.json"),PACKAGE_NAME:"@cyberskill/shared"};function eR(){return eM.apply(this,arguments)}function eM(){eM=r(function(){var e;return h(this,function(t){switch(t.label){case 0:if(!O.existsSync(eD.TS_CONFIG_PATH))return[3,2];return[4,eO("npx tsc -p ".concat(eD.TS_CONFIG_PATH," --noEmit"),"TypeScript checking...")];case 1:e=t.sent();return[3,3];case 2:e=ew("tsconfig.json file not found.","⚠️");t.label=3;case 3:e;return[2]}})});return eM.apply(this,arguments)}function eG(){return eW.apply(this,arguments)}function eW(){eW=r(function(){var e,t;var n=arguments;return h(this,function(r){switch(r.label){case 0:e=n.length>0&&n[0]!==void 0?n[0]:!1;t="npx eslint ".concat(eD.INIT_CWD).concat(e?" --fix":" --format json");return[4,eO(t,"Eslint ".concat(e?"fixing":"checking","..."))];case 1:r.sent();return[2]}})});return eW.apply(this,arguments)}function eq(){return eU.apply(this,arguments)}function eU(){eU=r(function(){var e;return h(this,function(t){switch(t.label){case 0:e="npx lint-staged --config ".concat(eD.LINT_STAGED_CONFIG_PATH);return[4,eO(e,"Lint-staged processing...")];case 1:t.sent();return[2]}})});return eU.apply(this,arguments)}function eH(){return eF.apply(this,arguments)}function eF(){eF=r(function(){return h(this,function(e){switch(e.label){case 0:ew("Starting lint check for ".concat(eD.INIT_CWD),"\uD83D\uDE80");return[4,el("Running lint checks...",/*#__PURE__*/r(function(){return h(this,function(e){switch(e.label){case 0:return[4,Y()];case 1:e.sent().length=0;return[4,Promise.all([eR(),eG()])];case 2:e.sent(),ea();return[2]}})}))];case 1:e.sent();return[2]}})});return eF.apply(this,arguments)}function eK(){return eL.apply(this,arguments)}function eL(){eL=r(function(){return h(this,function(e){switch(e.label){case 0:ew("Starting lint and format fix for ".concat(eD.INIT_CWD),"\uD83D\uDE80");return[4,el("Fixing issues...",/*#__PURE__*/r(function(){return h(this,function(e){switch(e.label){case 0:return[4,eG(!0)];case 1:e.sent();return[2]}})}))];case 1:e.sent();return[2]}})});return eL.apply(this,arguments)}function eJ(){return eB.apply(this,arguments)}function eB(){eB=r(function(){return h(this,function(e){switch(e.label){case 0:return[4,eO("npx @eslint/config-inspector","Lint inspect processing...")];case 1:e.sent();return[2]}})});return eB.apply(this,arguments)}function eY(){return e$.apply(this,arguments)}function e$(){e$=r(function(){return h(this,function(e){switch(e.label){case 0:ew("Starting lint-staged process for ".concat(E.default.env.INIT_CWD),"\uD83D\uDE80");return[4,el("Running lint-staged...",/*#__PURE__*/r(function(){return h(this,function(e){switch(e.label){case 0:return[4,Y()];case 1:e.sent().length=0;return[4,Promise.all([eR(),eq()])];case 2:e.sent(),ea();return[2]}})}))];case 1:e.sent();return[2]}})});return e$.apply(this,arguments)}function ez(){return eQ.apply(this,arguments)}function eQ(){eQ=r(function(){return h(this,function(e){switch(e.label){case 0:ew("Starting commitlint process for ".concat(eD.INIT_CWD),"\uD83D\uDE80");return[4,el("Running commitlint...",/*#__PURE__*/r(function(){var e,t;return h(this,function(n){switch(n.label){case 0:return[4,Y()];case 1:n.sent().length=0;e=T.resolve(j,"./configs/commitlint/commitlint.base.js"),t="npx --no -- commitlint --edit ".concat(eD.GIT_COMMIT_MSG," --config ").concat(e);return[4,eO(t,"Commitlint processing...")];case 2:n.sent(),ea();return[2]}})}))];case 1:e.sent();return[2]}})});return eQ.apply(this,arguments)}function eV(){return eX.apply(this,arguments)}function eX(){eX=r(function(){var e,t,n;return h(this,function(r){switch(r.label){case 0:e=O.existsSync(eD.HUSKY_PATH);if(!e)return[3,2];return[4,eO("npx rimraf ".concat(eD.HUSKY_PATH," ").concat(eD.GIT_HOOK_PATH," && git config core.hooksPath ").concat(eD.GIT_HOOK_PATH),"Removing husky hooks...")];case 1:e=r.sent();r.label=2;case 2:e;t=ex(eD.INIT_CWD,eD.PACKAGE_NAME),n='\n        echo "✅ Running lint..."\n        npx --yes cyberskill lint-staged || (echo "❌ Lint failed – aborting commit." && exit 1)\n    ';t&&(n='\n            echo "\uD83D\uDE80 Running build before commit..."\n            npm run build || (echo "❌ Build failed – aborting commit." && exit 1)\n            \n            '.concat(n.trim(),"\n        ")),O.writeFileSync(eD.SIMPLE_GIT_HOOKS_PATH,JSON.stringify({"pre-commit":n.trim(),"commit-msg":"npx --yes cyberskill commitlint"},null,4));return[4,eO("npx simple-git-hooks","Setting up git hooks...")];case 3:r.sent(),O.unlinkSync(eD.SIMPLE_GIT_HOOKS_PATH);return[2]}})});return eX.apply(this,arguments)}function eZ(){return e0.apply(this,arguments)}function e0(){e0=r(function(){return h(this,function(e){switch(e.label){case 0:ew("Starting setup process for ".concat(eD.INIT_CWD),"\uD83D\uDE80");return[4,el("Setting up...",/*#__PURE__*/r(function(){var e,t,n,c,a,o,l,f;return h(this,function(p){switch(p.label){case 0:e=T.join(eD.INIT_CWD,"package.json"),t=/*#__PURE__*/function(){var e=r(function(){var e,t,n,r;return h(this,function(s){switch(s.label){case 0:s.trys.push([0,2,,3]);e=T.join(eD.INIT_CWD,"node_modules",eD.PACKAGE_NAME,"package.json"),t=JSON.parse(O.readFileSync(e,"utf-8")).version;return[4,eA(eD.PACKAGE_NAME,!0)];case 1:n=s.sent();return[2,t!==n];case 2:r=s.sent();return[2,!0];case 3:return[2]}})});return function t(){return e.apply(this,arguments)}}(),n=/*#__PURE__*/function(){var t=r(function(){var t,n,r;return h(this,function(c){switch(c.label){case 0:c.trys.push([0,4,,5]);return[4,eA(eD.PACKAGE_NAME,!0)];case 1:t=c.sent(),n=JSON.parse(O.readFileSync(e,"utf-8"));n.dependencies=u(i({},n.dependencies),s({},eD.PACKAGE_NAME,t)),O.writeFileSync(e,JSON.stringify(n,null,2));return[4,eO("npm i -f","Installing all dependencies with updated Cyberskill...")];case 2:c.sent();return[4,eO("npm run lint:fix","Fixing lint issues...")];case 3:c.sent();return[3,5];case 4:r=c.sent();throw console.error("Failed to update Cyberskill: ".concat(r.message)),r;case 5:return[2]}})});return function e(){return t.apply(this,arguments)}}();p.label=1;case 1:p.trys.push([1,7,,8]);a=JSON.parse(O.readFileSync(e,"utf-8"));if(ex(eD.INIT_CWD,eD.PACKAGE_NAME)){ew("Cyberskill is the current project. No setup needed.","✅");return[2]}l=!((c=a.dependencies)===null||c===void 0?void 0:c[eD.PACKAGE_NAME]);if(l)return[3,3];return[4,t()];case 2:l=p.sent();p.label=3;case 3:if(!l)return[3,5];ew("Cyberskill is missing or outdated. Updating...");return[4,n()];case 4:o=p.sent();return[3,6];case 5:o=ew("Cyberskill is up to date","✅");p.label=6;case 6:o;return[3,8];case 7:f=p.sent();throw console.error("Error reading package.json: ".concat(f.message)),f;case 8:eV();return[2]}})}))];case 1:e.sent();return[2]}})});return e0.apply(this,arguments)}function e2(){return e1.apply(this,arguments)}function e1(){e1=r(function(){return h(this,function(e){switch(e.label){case 0:ew("Starting reset process for ".concat(eD.INIT_CWD),"\uD83D\uDE80");return[4,el("Resetting...",/*#__PURE__*/r(function(){return h(this,function(e){switch(e.label){case 0:return[4,eO("npx rimraf ".concat(eD.INIT_CWD,"/node_modules ").concat(eD.INIT_CWD,"/package-lock.json"),"Cleaning node_modules and package-lock.json...")];case 1:e.sent();return[4,eO("npm i -f","Installing all dependencies...")];case 2:e.sent(),eV();return[2]}})}))];case 1:e.sent();return[2]}})});return e1.apply(this,arguments)}function e4(){return e3.apply(this,arguments)}function e3(){e3=r(function(){var e;return h(this,function(t){switch(t.label){case 0:e=T.resolve(j,"./configs/vitest/react/unit.js");ew("Starting unit tests for ".concat(eD.INIT_CWD),"\uD83D\uDE80");return[4,el("Running unit tests...",/*#__PURE__*/r(function(){return h(this,function(t){switch(t.label){case 0:return[4,eO("npx vitest --config ".concat(e),"Running unit tests...")];case 1:t.sent();return[2]}})}))];case 1:t.sent();return[2]}})});return e3.apply(this,arguments)}function e5(){return e6.apply(this,arguments)}function e6(){e6=r(function(){var e;return h(this,function(t){switch(t.label){case 0:e=T.resolve(j,"./configs/vitest/react/e2e.js");ew("Starting e2e tests for ".concat(eD.INIT_CWD),"\uD83D\uDE80");return[4,el("Running end-to-end tests...",/*#__PURE__*/r(function(){return h(this,function(t){switch(t.label){case 0:return[4,eO("npx vitest --config ".concat(e),"Running e2e tests...")];case 1:t.sent();return[2]}})}))];case 1:t.sent();return[2]}})});return e6.apply(this,arguments)}(0,k.default)((0,P.hideBin)(E.default.argv)).command("lint","Run linting checks",eH).command("lint:fix","Fix linting and formatting issues",eK).command("lint:inspect","Inspect linting rules",eJ).command("lint-staged","Run lint-staged with given configuration",eY).command("commitlint","Run commitlint with given configuration",ez).command("setup","Run setup with given configuration",eZ).command("reset","Reset dependencies and install",e2).command("test:unit","Run unit tests",e4).command("test:e2e","Run e2e tests",e5).help().parse();