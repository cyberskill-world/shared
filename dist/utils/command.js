function e(e,r,t,n,o,s,c){try{var a=e[s](c);var i=a.value}catch(e){t(e);return}if(a.done){r(i)}else{Promise.resolve(i).then(n,o)}}function r(r){return function(){var t=this,n=arguments;return new Promise(function(o,s){var c=r.apply(t,n);function a(r){e(c,o,s,a,i,"next",r)}function i(r){e(c,o,s,a,i,"throw",r)}a(undefined)})}}function t(e,r){var t,n,o,s,c={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),"throw":a(1),"return":a(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(e){return function(r){return i([e,r])}}function i(s){if(t)throw new TypeError("Generator is already executing.");while(c)try{if(t=1,n&&(o=s[0]&2?n["return"]:s[0]?n["throw"]||((o=n["return"])&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;if(n=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:c.label++;return{value:s[1],done:false};case 5:c.label++;n=s[1];s=[0];continue;case 7:s=c.ops.pop();c.trys.pop();continue;default:if(!(o=c.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){c=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){c.label=s[1];break}if(s[0]===6&&c.label<o[1]){c.label=o[1];o=s;break}if(o&&c.label<o[2]){c.label=o[2];c.ops.push(s);break}if(o[2])c.ops.pop();c.trys.pop();continue}s=r.call(e,c)}catch(e){s=[6,e];n=0}finally{t=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}}import n from"chalk";import{exec as o}from"node:child_process";import s from"node:process";import*as c from"node:util";import a from"localforage";var i={get:function e(e){return r(function(){var r;return t(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,a.getItem(e)];case 1:return[2,t.sent()];case 2:r=t.sent();return[2,(console.error('Error getting key "'.concat(e,'":'),r),null)];case 3:return[2]}})})()},set:function e(e,n){return r(function(){var r;return t(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,a.setItem(e,n)];case 1:t.sent();return[3,3];case 2:r=t.sent();console.error('Error setting key "'.concat(e,'":'),r);return[3,3];case 3:return[2]}})})()},remove:function e(e){return r(function(){var r;return t(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,a.removeItem(e)];case 1:t.sent();return[3,3];case 2:r=t.sent();console.error('Error removing key "'.concat(e,'":'),r);return[3,3];case 3:return[2]}})})()},clear:function e(){return r(function(){var e;return t(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,a.clear()];case 1:r.sent();return[3,3];case 2:e=r.sent();console.error("Error clearing storage:",e);return[3,3];case 3:return[2]}})})()},key:function e(e){return r(function(){var r;return t(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,a.key(e)];case 1:return[2,t.sent()];case 2:r=t.sent();return[2,(console.error("Error getting key at index ".concat(e,":"),r),null)];case 3:return[2]}})})()},keys:function e(){return r(function(){var e;return t(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,a.keys()];case 1:return[2,r.sent()];case 2:e=r.sent();return[2,(console.error("Error getting keys:",e),[])];case 3:return[2]}})})()},length:function e(){return r(function(){var e;return t(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,a.length()];case 1:return[2,r.sent()];case 2:e=r.sent();return[2,(console.error("Error getting storage length:",e),0)];case 3:return[2]}})})()},iterate:function e(e){return r(function(){var r;return t(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,a.iterate(e)];case 1:t.sent();return[3,3];case 2:r=t.sent();console.error("Error iterating storage:",r);return[3,3];case 3:return[2]}})})()}};var u=function(e){return"error_list:".concat(e)},l=24*60*60*1e3;function f(e){return h.apply(this,arguments)}function h(){h=r(function(e){var r,n,o;return t(this,function(t){switch(t.label){case 0:if(!e.length)return[2];r=Date.now(),n=u(r);t.label=1;case 1:t.trys.push([1,3,,4]);return[4,i.set(n,{errors:e,timestamp:r})];case 2:t.sent(),console.log("✅ Saved ".concat(e.length," errors to storage with key: ").concat(n));return[3,4];case 3:o=t.sent();console.error("❌ Failed to save errors: ".concat(o.message));return[3,4];case 4:return[2]}})});return h.apply(this,arguments)}var p=c.promisify(o),g=n.gray,m=n.white,y=[];function v(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";var t=new Date().toLocaleString();console.log("".concat(r," [").concat(t,"] ").concat(m(e)))}function d(e){var r=/^\s*(\d+):(\d+)\s+(error|warning)\s+(\S+)\s+(\S+)$/,t=/^(.+?)\((\d+),(\d+)\):\s+(error|warning)\s+TS\d+:\s+(\S.+)$/,n=/^✖\s+(.*?)\s+\[(.*?)\]$/,o=[],s="";e.split("\n").forEach(function(e){if(e.startsWith("/"))s=e.trim();else{var c=r.exec(e);if(c&&s)y.push({file:s,position:"".concat(c[1],":").concat(c[2]),type:c[3]==="error"?"error":"warning",message:c[4].trim(),rule:c[5].trim()});else{var a=t.exec(e);if(a)y.push({file:a[1],position:"".concat(a[2],":").concat(a[3]),type:a[4],message:a[5].trim()});else{var i=n.exec(e);i?y.push({file:"commitlint",type:"error",message:i[1].trim(),rule:i[2].trim()}):o.push(e.trim())}}}}),o.length>0&&(console.log(g("Unmatched lines:")),o.forEach(function(e){return console.info(e)}))}function b(e){try{JSON.parse(e).forEach(function(e){var r=e.filePath,t=e.messages;t.forEach(function(e){var t=e.severity,n=e.line,o=e.column,s=e.ruleId,c=e.message;y.push({type:t===2?"error":"warning",file:r,position:"".concat(n,":").concat(o),rule:s,message:c})})})}catch(r){d(e)}}function w(e,r){return k.apply(this,arguments)}function k(){k=r(function(e,r){var n,o,c,a,i,u,l;var h=arguments;return t(this,function(t){switch(t.label){case 0:n=h.length>2&&h[2]!==void 0?h[2]:b;v(r);o=new AbortController;s.on("SIGINT",function(){console.log("Terminating process..."),o.abort(),s.exit()});t.label=1;case 1:t.trys.push([1,5,,6]);return[4,p(e,{maxBuffer:0x6400000,signal:o.signal})];case 2:c=t.sent(),a=c.stdout,i=c.stderr;[a,i].forEach(function(e){return e&&n(e)});u=y.length;if(!u)return[3,4];return[4,f(y)];case 3:u=t.sent();t.label=4;case 4:u;return[3,6];case 5:l=t.sent();console.error("Command failed: ".concat(l.message));return[3,6];case 6:return[2]}})});return k.apply(this,arguments)}export{w as executeCommand,v as logProcessStep};