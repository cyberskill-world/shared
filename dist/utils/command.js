function r(r,e,n,t,o,s,a){try{var c=r[s](a);var i=c.value}catch(r){n(r);return}if(c.done){e(i)}else{Promise.resolve(i).then(t,o)}}function e(e){return function(){var n=this,t=arguments;return new Promise(function(o,s){var a=e.apply(n,t);function c(e){r(a,o,s,c,i,"next",e)}function i(e){r(a,o,s,c,i,"throw",e)}c(undefined)})}}function n(r){"@swc/helpers - typeof";return r&&typeof Symbol!=="undefined"&&r.constructor===Symbol?"symbol":typeof r}function t(r,e){var n,t,o,s,a={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]};return s={next:c(0),"throw":c(1),"return":c(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function c(r){return function(e){return i([r,e])}}function i(s){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,t&&(o=s[0]&2?t["return"]:s[0]?t["throw"]||((o=t["return"])&&o.call(t),0):t.next)&&!(o=o.call(t,s[1])).done)return o;if(t=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:a.label++;return{value:s[1],done:false};case 5:a.label++;t=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(o=a.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){a=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(s[0]===6&&a.label<o[1]){a.label=o[1];o=s;break}if(o&&a.label<o[2]){a.label=o[2];a.ops.push(s);break}if(o[2])a.ops.pop();a.trys.pop();continue}s=e.call(r,a)}catch(r){s=[6,r];t=0}finally{n=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}}import o from"boxen";import s from"chalk";import{exec as a}from"node:child_process";import c from"node:process";import*as i from"node:util";import u from"localforage";import l from"node-persist";import f from"node:os";import p from"node:path";import g from"node:process";var h=(typeof window==="undefined"?"undefined":n(window))<"u",d=g.env.CYBERSKILL_STORAGE_DIR||p.join(f.homedir(),".cyberskill-storage");function m(){return y.apply(this,arguments)}function y(){y=e(function(){var r;return t(this,function(e){switch(e.label){case 0:r=!h&&!l.defaultInstance;if(!r)return[3,2];return[4,l.init({dir:d,stringify:JSON.stringify,parse:JSON.parse,encoding:"utf8",logging:!1,forgiveParseErrors:!0})];case 1:r=e.sent();e.label=2;case 2:r;return[2]}})});return y.apply(this,arguments)}var v={get:function r(r){return e(function(){var e,n,o;return t(this,function(t){switch(t.label){case 0:t.trys.push([0,6,,7]);if(!h)return[3,2];return[4,u.getItem(r)];case 1:n=t.sent();return[3,5];case 2:return[4,m()];case 3:t.sent();return[4,l.getItem(r)];case 4:n=(e=t.sent())!==null&&e!==void 0?e:null;t.label=5;case 5:return[2,n];case 6:o=t.sent();return[2,(console.error('❌ [Storage:get] Error getting key "'.concat(r,'":'),o),null)];case 7:return[2]}})})()},set:function r(r,n){return e(function(){var e,o;return t(this,function(t){switch(t.label){case 0:t.trys.push([0,6,,7]);if(!h)return[3,2];return[4,u.setItem(r,n)];case 1:e=t.sent();return[3,5];case 2:return[4,m()];case 3:t.sent();return[4,l.setItem(r,n)];case 4:e=t.sent();t.label=5;case 5:e;return[3,7];case 6:o=t.sent();console.error('❌ [Storage:set] Error setting key "'.concat(r,'":'),o);return[3,7];case 7:return[2]}})})()},remove:function r(r){return e(function(){var e,n;return t(this,function(t){switch(t.label){case 0:t.trys.push([0,6,,7]);if(!h)return[3,2];return[4,u.removeItem(r)];case 1:e=t.sent();return[3,5];case 2:return[4,m()];case 3:t.sent();return[4,l.removeItem(r)];case 4:e=t.sent();t.label=5;case 5:e;return[3,7];case 6:n=t.sent();console.error('❌ [Storage:remove] Error removing key "'.concat(r,'":'),n);return[3,7];case 7:return[2]}})})()},keys:function r(){return e(function(){var r,e,n;return t(this,function(t){switch(t.label){case 0:t.trys.push([0,5,,6]);if(!h)return[3,2];return[4,u.keys()];case 1:return[2,(r=t.sent())!==null&&r!==void 0?r:[]];case 2:return[4,m()];case 3:t.sent();return[4,l.keys()];case 4:e=t.sent();return[2,Array.isArray(e)?e:(console.warn("⚠️ [Storage:keys] Invalid keys response:",e),[])];case 5:n=t.sent();return[2,(console.error("❌ [Storage:keys] Error getting keys:",n),[])];case 6:return[2]}})})()},getLogLink:function r(r){return e(function(){return t(this,function(e){try{return[2,"".concat(d," (key: ").concat(r,")")]}catch(r){return[2,(console.error("❌ [Storage:getLogLink] Error getting log link:",r),null)]}return[2]})})()}};var b=c.env.DEBUG==="true",w=i.promisify(a),S=s.gray,E=s.blue,k=function(){return S("[".concat(new Date().toLocaleTimeString(),"]"))};function x(r){var e=s[r];return typeof e=="function"?e:s.green}function I(r,e,n,t){var o=x(e);console.log("".concat(k()," ").concat(o("".concat(n," ").concat(r))," ").concat(t))}function L(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},t=n.color,s=t===void 0?"green":t,a=n.padding,c=a===void 0?1:a,i=n.margin,u=i===void 0?1:i,l=n.borderStyle,f=l===void 0?"round":l,p=n.titleColor,g=p===void 0?"bold":p;var h=x(s),d=x(g);if(typeof e=="string"){console.log(o(d(h("".concat(r,"\n").concat(e))),{padding:c,margin:u,borderStyle:f,borderColor:s}));return}Array.isArray(e)&&e.length&&(e.forEach(function(r){var e=r.file,n=r.position,t=r.rule,o=r.message;console.log("".concat(k()," ").concat(h("File:")," ").concat(E("".concat(e).concat(n?":".concat(n):"")))),t&&console.log("   ".concat(h("Rule:")," ").concat(h(t))),console.log("   ".concat(h("Message:")," ").concat(h(o)))}),console.log(o(d(h("".concat(r,": ").concat(e.length))),{padding:c,margin:u,borderStyle:f,borderColor:s})),console.log(S("─".repeat(40))))}var _={success:function(r){return I("SUCCESS","green","✔",r)},error:function(r){return I("ERROR","red","✖",r)},warning:function(r){return I("WARNING","yellow","⚠",r)},info:function(r){return I("INFO","blue","ℹ",r)},printBoxedLog:L},A=function(r){return"error_list:".concat(r)};function R(r){return C.apply(this,arguments)}function C(){C=e(function(r){var n,o,s;return t(this,function(a){switch(a.label){case 0:if(r.length===0)return[2];n=Date.now(),o=A(n);a.label=1;case 1:a.trys.push([1,3,,4]);return[4,v.set(o,{errors:r,timestamp:n})];case 2:a.sent(),setTimeout(/*#__PURE__*/e(function(){var r;return t(this,function(e){switch(e.label){case 0:return[4,v.getLogLink(o)];case 1:r=e.sent();r&&_.info("\uD83D\uDCC2 Open the error list manually: ".concat(r));return[2]}})}),10);return[3,4];case 3:s=a.sent();_.error("Failed to save errors: ".concat(s.message));return[3,4];case 4:return[2]}})});return C.apply(this,arguments)}function P(){return T.apply(this,arguments)}function T(){T=e(function(){var r,n,o;return t(this,function(s){switch(s.label){case 0:s.trys.push([0,3,,4]);return[4,v.keys()];case 1:r=s.sent(),n=Array.isArray(r)?r.filter(function(r){var e;return r===null||r===void 0?void 0:(e=r.startsWith)===null||e===void 0?void 0:e.call(r,"error_list:")}):[];return[4,Promise.all(n.map(/*#__PURE__*/function(){var r=e(function(r){var e;return t(this,function(n){switch(n.label){case 0:return[4,v.get(r)];case 1:return[2,((e=n.sent())===null||e===void 0?void 0:e.errors)||[]]}})});return function(e){return r.apply(this,arguments)}}()))];case 2:return[2,s.sent().flat()];case 3:o=s.sent();return[2,(_.error("Failed to retrieve stored errors: ".concat(o.message)),[])];case 4:return[2]}})});return T.apply(this,arguments)}function N(){return O.apply(this,arguments)}function O(){O=e(function(){var r,e,n;return t(this,function(t){switch(t.label){case 0:t.trys.push([0,3,,4]);return[4,v.keys()];case 1:r=t.sent(),e=Array.isArray(r)?r.filter(function(r){var e;return r===null||r===void 0?void 0:(e=r.startsWith)===null||e===void 0?void 0:e.call(r,"error_list:")}):[];return[4,Promise.all(e.map(function(r){return v.remove(r)}))];case 2:t.sent();return[3,4];case 3:n=t.sent();_.error("Failed to clear error lists: ".concat(n.message));return[3,4];case 4:return[2]}})});return O.apply(this,arguments)}function F(r){var e=[],n=[],t="",o=/^\s*(\d+):(\d+)\s+(error|warning)\s+(.+?)\s+(\S+)$/,s=/^(.+?)\((\d+),(\d+)\):\s+(error|warning)\s+TS\d+:\s+(\S.+)$/,a=/^✖\s+(.*?)\s+\[(.*?)\]$/;r.split("\n").forEach(function(r){if(r.startsWith("/"))t=r.trim();else{var c=o.exec(r)||[],i=s.exec(r)||[],u=a.exec(r)||[];c.length&&t?e.push({file:t,position:"".concat(c[1],":").concat(c[2]),type:c[3]==="error"?"error":"warning",message:c[4].trim(),rule:c[5].trim()}):i.length?e.push({file:i[1],position:"".concat(i[2],":").concat(i[3]),type:i[4]==="error"?"error":"warning",message:i[5].trim()}):u.length?e.push({file:"commitlint",type:"error",message:u[1].trim(),rule:u[2].trim()}):n.push(r.trim())}}),e.length&&R(e),n.length&&b&&(_.warning("Unmatched lines:"),n.forEach(function(r){return console.log("  ".concat(r))}))}function G(r){try{var e=JSON.parse(r),n=[];e.forEach(function(r){var e=r.filePath,t=r.messages;t.forEach(function(r){var t=r.severity,o=r.line,s=r.column,a=r.ruleId,c=r.message;n.push({type:t===2?"error":"warning",file:e,position:"".concat(o,":").concat(s),rule:a,message:c})})}),n.length&&R(n)}catch(e){F(r)}}function U(r){return B.apply(this,arguments)}function B(){B=e(function(r){var e,n,o,s,a,i,u,l,f;var p=arguments;return t(this,function(t){switch(t.label){case 0:e=p.length>1&&p[1]!==void 0?p[1]:G;n=new AbortController;c.on("SIGINT",function(){_.warning("Process interrupted. Terminating..."),n.abort(),c.exit()});t.label=1;case 1:t.trys.push([1,3,,4]);return[4,w(r,{maxBuffer:0x6400000,signal:n.signal})];case 2:o=t.sent(),s=o.stdout,a=o.stderr;[s,a].forEach(function(r){return r&&e(r)});return[3,4];case 3:i=t.sent();u=i.stdout,l=i.stderr,f=i.message;[u,l].forEach(function(r){return r&&e(r)}),!l&&!u&&_.error("Command failed: ".concat(f));return[3,4];case 4:return[2]}})});return B.apply(this,arguments)}export{N as clearAllErrorLists,_ as commandLog,U as executeCommand,P as getStoredErrorLists,R as saveErrorListToStorage};