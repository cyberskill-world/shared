"use strict";function r(r,e,t,n,o,a,u){try{var c=r[a](u);var s=c.value}catch(r){t(r);return}if(c.done){e(s)}else{Promise.resolve(s).then(n,o)}}function e(e){return function(){var t=this,n=arguments;return new Promise(function(o,a){var u=e.apply(t,n);function c(e){r(u,o,a,c,s,"next",e)}function s(e){r(u,o,a,c,s,"throw",e)}c(undefined)})}}function t(r){"@swc/helpers - typeof";return r&&typeof Symbol!=="undefined"&&r.constructor===Symbol?"symbol":typeof r}function n(r,e){var t,n,o,a,u={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),"throw":c(1),"return":c(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(r){return function(e){return s([r,e])}}function s(a){if(t)throw new TypeError("Generator is already executing.");while(u)try{if(t=1,n&&(o=a[0]&2?n["return"]:a[0]?n["throw"]||((o=n["return"])&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;if(n=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:u.label++;return{value:a[1],done:false};case 5:u.label++;n=a[1];a=[0];continue;case 7:a=u.ops.pop();u.trys.pop();continue;default:if(!(o=u.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){u=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){u.label=a[1];break}if(a[0]===6&&u.label<o[1]){u.label=o[1];o=a;break}if(o&&u.label<o[2]){u.label=o[2];u.ops.push(a);break}if(o[2])u.ops.pop();u.trys.pop();continue}a=e.call(r,u)}catch(r){a=[6,r];n=0}finally{t=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}}var o=Object.create;var a=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var c=Object.getOwnPropertyNames;var s=Object.getPrototypeOf,i=Object.prototype.hasOwnProperty;var l=function(r,e){for(var t in e)a(r,t,{get:e[t],enumerable:!0})},f=function(r,e,n,o){var s=true,l=false,f=undefined;if(e&&(typeof e==="undefined"?"undefined":t(e))=="object"||typeof e=="function")try{var d=function(){var t=p.value;!i.call(r,t)&&t!==n&&a(r,t,{get:function(){return e[t]},enumerable:!(o=u(e,t))||o.enumerable})};for(var g=c(e)[Symbol.iterator](),p;!(s=(p=g.next()).done);s=true)d()}catch(r){l=true;f=r}finally{try{if(!s&&g.return!=null){g.return()}}finally{if(l){throw f}}}return r};var d=function(r,e,t){return t=r!=null?o(s(r)):{},f(e||!r||!r.__esModule?a(t,"default",{value:r,enumerable:!0}):t,r)},g=function(r){return f(a({},"__esModule",{value:!0}),r)};var p={};l(p,{clearAllErrorLists:function(){return J},commandLog:function(){return D},executeCommand:function(){return Y},getStoredErrorLists:function(){return B},saveErrorListToStorage:function(){return G}});module.exports=g(p);var h=d(require("boxen"),1),v=d(require("chalk"),1),y=require("child_process"),m=d(require("process"),1),b=d(require("util"),1);var w=d(require("node-persist"),1),S=d(require("os"),1),E=d(require("path"),1),k=d(require("process"),1),L=k.default.env.CYBERSKILL_STORAGE_DIR||E.default.join(S.default.homedir(),".cyberskill-storage");function x(){return _.apply(this,arguments)}function _(){_=e(function(){var r;return n(this,function(e){switch(e.label){case 0:r=w.default.defaultInstance;if(r)return[3,2];return[4,w.default.init({dir:L,stringify:JSON.stringify,parse:JSON.parse,encoding:"utf8",logging:!1,forgiveParseErrors:!0})];case 1:r=e.sent();e.label=2;case 2:r;return[2]}})});return _.apply(this,arguments)}var O={get:function r(r){return e(function(){var e,t;return n(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,x()];case 1:n.sent();return[4,w.default.getItem(r)];case 2:return[2,(e=n.sent())!==null&&e!==void 0?e:null];case 3:t=n.sent();return[2,(console.error('❌ [Storage:get] Error getting key "'.concat(r,'":'),t),null)];case 4:return[2]}})})()},set:function r(r,t){return e(function(){var e;return n(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,x()];case 1:n.sent();return[4,w.default.setItem(r,t)];case 2:n.sent();return[3,4];case 3:e=n.sent();console.error('❌ [Storage:set] Error setting key "'.concat(r,'":'),e);return[3,4];case 4:return[2]}})})()},remove:function r(r){return e(function(){var e;return n(this,function(t){switch(t.label){case 0:t.trys.push([0,3,,4]);return[4,x()];case 1:t.sent();return[4,w.default.removeItem(r)];case 2:t.sent();return[3,4];case 3:e=t.sent();console.error('❌ [Storage:remove] Error removing key "'.concat(r,'":'),e);return[3,4];case 4:return[2]}})})()},keys:function r(){return e(function(){var r,e;return n(this,function(t){switch(t.label){case 0:t.trys.push([0,3,,4]);return[4,x()];case 1:t.sent();return[4,w.default.keys()];case 2:r=t.sent();return[2,Array.isArray(r)?r:(console.warn("⚠️ [Storage:keys] Invalid keys response:",r),[])];case 3:e=t.sent();return[2,(console.error("❌ [Storage:keys] Error getting keys:",e),[])];case 4:return[2]}})})()},getLogLink:function r(r){return e(function(){return n(this,function(e){try{return[2,"".concat(L," (key: ").concat(r,")")]}catch(r){return[2,(console.error("❌ [Storage:getLogLink] Error getting log link:",r),null)]}return[2]})})()}};var A=m.default.env.DEBUG==="true",P=b.promisify(y.exec),I=v.default,C=I.gray,R=I.blue,T=function(){return C("[".concat(new Date().toLocaleTimeString(),"]"))};function q(r){var e=v.default[r];return typeof e=="function"?e:v.default.green}function j(r,e,t,n){var o=q(e);console.log("".concat(T()," ").concat(o("".concat(t," ").concat(r))," ").concat(n))}function N(r,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=t.color,o=n===void 0?"green":n,a=t.padding,u=a===void 0?1:a,c=t.margin,s=c===void 0?1:c,i=t.borderStyle,l=i===void 0?"round":i,f=t.titleColor,d=f===void 0?"bold":f;var g=q(o),p=q(d);if(typeof e=="string"){console.log((0,h.default)(p(g("".concat(r,"\n").concat(e))),{padding:u,margin:s,borderStyle:l,borderColor:o}));return}Array.isArray(e)&&e.length&&(e.forEach(function(r){var e=r.file,t=r.position,n=r.rule,o=r.message;console.log("".concat(T()," ").concat(g("File:")," ").concat(R("".concat(e).concat(t?":".concat(t):"")))),n&&console.log("   ".concat(g("Rule:")," ").concat(g(n))),console.log("   ".concat(g("Message:")," ").concat(g(o)))}),console.log((0,h.default)(p(g("".concat(r,": ").concat(e.length))),{padding:u,margin:s,borderStyle:l,borderColor:o})),console.log(C("─".repeat(40))))}var D={success:function(r){return j("SUCCESS","green","✔",r)},error:function(r){return j("ERROR","red","✖",r)},warning:function(r){return j("WARNING","yellow","⚠",r)},info:function(r){return j("INFO","blue","ℹ",r)},printBoxedLog:N},F=function(r){return"error_list:".concat(r)};function G(r){return U.apply(this,arguments)}function U(){U=e(function(r){var t,o,a;return n(this,function(u){switch(u.label){case 0:if(r.length===0)return[2];t=Date.now(),o=F(t);u.label=1;case 1:u.trys.push([1,3,,4]);return[4,O.set(o,{errors:r,timestamp:t})];case 2:u.sent(),setTimeout(/*#__PURE__*/e(function(){var r;return n(this,function(e){switch(e.label){case 0:return[4,O.getLogLink(o)];case 1:r=e.sent();r&&D.info("\uD83D\uDCC2 Open the error list manually: ".concat(r));return[2]}})}),10);return[3,4];case 3:a=u.sent();D.error("Failed to save errors: ".concat(a.message));return[3,4];case 4:return[2]}})});return U.apply(this,arguments)}function B(){return W.apply(this,arguments)}function W(){W=e(function(){var r,t,o;return n(this,function(a){switch(a.label){case 0:a.trys.push([0,3,,4]);return[4,O.keys()];case 1:r=a.sent(),t=Array.isArray(r)?r.filter(function(r){var e;return r===null||r===void 0?void 0:(e=r.startsWith)===null||e===void 0?void 0:e.call(r,"error_list:")}):[];return[4,Promise.all(t.map(/*#__PURE__*/function(){var r=e(function(r){var e;return n(this,function(t){switch(t.label){case 0:return[4,O.get(r)];case 1:return[2,((e=t.sent())===null||e===void 0?void 0:e.errors)||[]]}})});return function(e){return r.apply(this,arguments)}}()))];case 2:return[2,a.sent().flat()];case 3:o=a.sent();return[2,(D.error("Failed to retrieve stored errors: ".concat(o.message)),[])];case 4:return[2]}})});return W.apply(this,arguments)}function J(){return M.apply(this,arguments)}function M(){M=e(function(){var r,e,t;return n(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,O.keys()];case 1:r=n.sent(),e=Array.isArray(r)?r.filter(function(r){var e;return r===null||r===void 0?void 0:(e=r.startsWith)===null||e===void 0?void 0:e.call(r,"error_list:")}):[];return[4,Promise.all(e.map(function(r){return O.remove(r)}))];case 2:n.sent();return[3,4];case 3:t=n.sent();D.error("Failed to clear error lists: ".concat(t.message));return[3,4];case 4:return[2]}})});return M.apply(this,arguments)}function $(r){var e=[],t=[],n="",o=/^\s*(\d+):(\d+)\s+(error|warning)\s+(.+?)\s+(\S+)$/,a=/^(.+?)\((\d+),(\d+)\):\s+(error|warning)\s+TS\d+:\s+(\S.+)$/,u=/^✖\s+(.*?)\s+\[(.*?)\]$/;r.split("\n").forEach(function(r){if(r.startsWith("/"))n=r.trim();else{var c=o.exec(r)||[],s=a.exec(r)||[],i=u.exec(r)||[];c.length&&n?e.push({file:n,position:"".concat(c[1],":").concat(c[2]),type:c[3]==="error"?"error":"warning",message:c[4].trim(),rule:c[5].trim()}):s.length?e.push({file:s[1],position:"".concat(s[2],":").concat(s[3]),type:s[4]==="error"?"error":"warning",message:s[5].trim()}):i.length?e.push({file:"commitlint",type:"error",message:i[1].trim(),rule:i[2].trim()}):t.push(r.trim())}}),e.length&&G(e),t.length&&A&&(D.warning("Unmatched lines:"),t.forEach(function(r){return console.log("  ".concat(r))}))}function K(r){try{var e=JSON.parse(r),t=[];e.forEach(function(r){var e=r.filePath,n=r.messages;n.forEach(function(r){var n=r.severity,o=r.line,a=r.column,u=r.ruleId,c=r.message;t.push({type:n===2?"error":"warning",file:e,position:"".concat(o,":").concat(a),rule:u,message:c})})}),t.length&&G(t)}catch(e){$(r)}}function Y(r){return z.apply(this,arguments)}function z(){z=e(function(r){var e,t,o,a,u,c,s,i,l;var f=arguments;return n(this,function(n){switch(n.label){case 0:e=f.length>1&&f[1]!==void 0?f[1]:K;t=new AbortController;m.default.on("SIGINT",function(){D.warning("Process interrupted. Terminating..."),t.abort(),m.default.exit()});n.label=1;case 1:n.trys.push([1,3,,4]);return[4,P(r,{maxBuffer:0x6400000,signal:t.signal})];case 2:o=n.sent(),a=o.stdout,u=o.stderr;[a,u].forEach(function(r){return r&&e(r)});return[3,4];case 3:c=n.sent();s=c.stdout,i=c.stderr,l=c.message;[s,i].forEach(function(r){return r&&e(r)}),!i&&!s&&D.error("Command failed: ".concat(l));return[3,4];case 4:return[2]}})});return z.apply(this,arguments)}0&&(module.exports={clearAllErrorLists:clearAllErrorLists,commandLog:commandLog,executeCommand:executeCommand,getStoredErrorLists:getStoredErrorLists,saveErrorListToStorage:saveErrorListToStorage});