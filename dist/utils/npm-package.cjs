"use strict";function e(e,t,r,n,o,a,c){try{var s=e[a](c);var i=s.value}catch(e){r(e);return}if(s.done){t(i)}else{Promise.resolve(i).then(n,o)}}function t(t){return function(){var r=this,n=arguments;return new Promise(function(o,a){var c=t.apply(r,n);function s(t){e(c,o,a,s,i,"next",t)}function i(t){e(c,o,a,s,i,"throw",t)}s(undefined)})}}function r(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function n(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};var o=Object.keys(n);if(typeof Object.getOwnPropertySymbols==="function"){o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))}o.forEach(function(t){r(e,t,n[t])})}return e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);if(t){n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})}r.push.apply(r,n)}return r}function a(e,t){t=t!=null?t:{};if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(t))}else{o(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function c(e){"@swc/helpers - typeof";return e&&typeof Symbol!=="undefined"&&e.constructor===Symbol?"symbol":typeof e}function s(e,t){var r,n,o,a,c={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),"throw":s(1),"return":s(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return i([e,t])}}function i(a){if(r)throw new TypeError("Generator is already executing.");while(c)try{if(r=1,n&&(o=a[0]&2?n["return"]:a[0]?n["throw"]||((o=n["return"])&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;if(n=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:c.label++;return{value:a[1],done:false};case 5:c.label++;n=a[1];a=[0];continue;case 7:a=c.ops.pop();c.trys.pop();continue;default:if(!(o=c.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){c=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){c.label=a[1];break}if(a[0]===6&&c.label<o[1]){c.label=o[1];o=a;break}if(o&&c.label<o[2]){c.label=o[2];c.ops.push(a);break}if(o[2])c.ops.pop();c.trys.pop();continue}a=t.call(e,c)}catch(e){a=[6,e];n=0}finally{r=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}}var i=Object.create;var u=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var f=Object.getOwnPropertyNames;var p=Object.getPrototypeOf,d=Object.prototype.hasOwnProperty;var h=function(e,t){for(var r in t)u(e,r,{get:t[r],enumerable:!0})},g=function(e,t,r,n){var o=true,a=false,s=undefined;if(t&&(typeof t==="undefined"?"undefined":c(t))=="object"||typeof t=="function")try{var i=function(){var o=h.value;!d.call(e,o)&&o!==r&&u(e,o,{get:function(){return t[o]},enumerable:!(n=l(t,o))||n.enumerable})};for(var p=f(t)[Symbol.iterator](),h;!(o=(h=p.next()).done);o=true)i()}catch(e){a=true;s=e}finally{try{if(!o&&p.return!=null){p.return()}}finally{if(a){throw s}}}return e};var v=function(e,t,r){return r=e!=null?i(p(e)):{},g(t||!e||!e.__esModule?u(r,"default",{value:e,enumerable:!0}):r,e)},y=function(e){return g(u({},"__esModule",{value:!0}),e)};var b={};h(b,{getLatestPackageVersion:function(){return B},isPackageOutdated:function(){return K},updatePackage:function(){return R}});module.exports=y(b);var m=v(require("node-fetch"),1),w=v(require("fs"),1),O=v(require("path"),1),k=v(require("process"),1);var P=v(require("chalk"),1),j=require("child_process"),S=v(require("process"),1),x=v(require("util"),1);var E=v(require("localforage"),1),D={get:function e(e){return t(function(){var t;return s(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,E.default.getItem(e)];case 1:return[2,r.sent()];case 2:t=r.sent();return[2,(console.error('Error getting key "'.concat(e,'":'),t),null)];case 3:return[2]}})})()},set:function e(e,r){return t(function(){var t;return s(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,E.default.setItem(e,r)];case 1:n.sent();return[3,3];case 2:t=n.sent();console.error('Error setting key "'.concat(e,'":'),t);return[3,3];case 3:return[2]}})})()},remove:function e(e){return t(function(){var t;return s(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,E.default.removeItem(e)];case 1:r.sent();return[3,3];case 2:t=r.sent();console.error('Error removing key "'.concat(e,'":'),t);return[3,3];case 3:return[2]}})})()},clear:function e(){return t(function(){var e;return s(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,E.default.clear()];case 1:t.sent();return[3,3];case 2:e=t.sent();console.error("Error clearing storage:",e);return[3,3];case 3:return[2]}})})()},key:function e(e){return t(function(){var t;return s(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,E.default.key(e)];case 1:return[2,r.sent()];case 2:t=r.sent();return[2,(console.error("Error getting key at index ".concat(e,":"),t),null)];case 3:return[2]}})})()},keys:function e(){return t(function(){var e;return s(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,E.default.keys()];case 1:return[2,t.sent()];case 2:e=t.sent();return[2,(console.error("Error getting keys:",e),[])];case 3:return[2]}})})()},length:function e(){return t(function(){var e;return s(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,E.default.length()];case 1:return[2,t.sent()];case 2:e=t.sent();return[2,(console.error("Error getting storage length:",e),0)];case 3:return[2]}})})()},iterate:function e(e){return t(function(){var t;return s(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,E.default.iterate(e)];case 1:r.sent();return[3,3];case 2:t=r.sent();console.error("Error iterating storage:",t);return[3,3];case 3:return[2]}})})()}};var F=function(e){return"error_list:".concat(e)},I=24*60*60*1e3;function q(e){return _.apply(this,arguments)}function _(){_=t(function(e){var t,r,n;return s(this,function(o){switch(o.label){case 0:if(!e.length)return[2];t=Date.now(),r=F(t);o.label=1;case 1:o.trys.push([1,3,,4]);return[4,D.set(r,{errors:e,timestamp:t})];case 2:o.sent(),console.log("✅ Saved ".concat(e.length," errors to storage with key: ").concat(r));return[3,4];case 3:n=o.sent();console.error("❌ Failed to save errors: ".concat(n.message));return[3,4];case 4:return[2]}})});return _.apply(this,arguments)}var M=x.promisify(j.exec),N=P.default,L=N.gray,T=N.white,C=[];function J(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";var r=new Date().toLocaleString();console.log("".concat(t," [").concat(r,"] ").concat(T(e)))}function U(e){var t=/^\s*(\d+):(\d+)\s+(error|warning)\s+(\S+)\s+(\S+)$/,r=/^(.+?)\((\d+),(\d+)\):\s+(error|warning)\s+TS\d+:\s+(\S.+)$/,n=/^✖\s+(.*?)\s+\[(.*?)\]$/,o=[],a="";e.split("\n").forEach(function(e){if(e.startsWith("/"))a=e.trim();else{var c=t.exec(e);if(c&&a)C.push({file:a,position:"".concat(c[1],":").concat(c[2]),type:c[3]==="error"?"error":"warning",message:c[4].trim(),rule:c[5].trim()});else{var s=r.exec(e);if(s)C.push({file:s[1],position:"".concat(s[2],":").concat(s[3]),type:s[4],message:s[5].trim()});else{var i=n.exec(e);i?C.push({file:"commitlint",type:"error",message:i[1].trim(),rule:i[2].trim()}):o.push(e.trim())}}}}),o.length>0&&(console.log(L("Unmatched lines:")),o.forEach(function(e){return console.info(e)}))}function V(e){try{JSON.parse(e).forEach(function(e){var t=e.filePath,r=e.messages;r.forEach(function(e){var r=e.severity,n=e.line,o=e.column,a=e.ruleId,c=e.message;C.push({type:r===2?"error":"warning",file:t,position:"".concat(n,":").concat(o),rule:a,message:c})})})}catch(t){U(e)}}function $(e,t){return G.apply(this,arguments)}function G(){G=t(function(e,t){var r,n,o,a,c,i,u;var l=arguments;return s(this,function(s){switch(s.label){case 0:r=l.length>2&&l[2]!==void 0?l[2]:V;J(t);n=new AbortController;S.default.on("SIGINT",function(){console.log("Terminating process..."),n.abort(),S.default.exit()});s.label=1;case 1:s.trys.push([1,5,,6]);return[4,M(e,{maxBuffer:0x6400000,signal:n.signal})];case 2:o=s.sent(),a=o.stdout,c=o.stderr;[a,c].forEach(function(e){return e&&r(e)});i=C.length;if(!i)return[3,4];return[4,q(C)];case 3:i=s.sent();s.label=4;case 4:i;return[3,6];case 5:u=s.sent();console.error("Command failed: ".concat(u.message));return[3,6];case 6:return[2]}})});return G.apply(this,arguments)}var A=24*60*60*1e3;function B(e){return W.apply(this,arguments)}function W(){W=t(function(e){var t,r,n,o,a,c,i,u,l,f;var p=arguments;return s(this,function(s){switch(s.label){case 0:t=p.length>1&&p[1]!==void 0?p[1]:!1;r="npm_version:".concat(e),n="npm_metadata:".concat(e);return[4,D.get(r)];case 1:o=s.sent();return[4,D.get(n)];case 2:a=s.sent(),c=o&&Date.now()-o.timestamp<A;if(!t&&c)return[2,(console.log("Using cached version for ".concat(e,": ").concat(o.version)),o.version)];i={};(a===null||a===void 0?void 0:a.etag)&&(i["If-None-Match"]=a.etag),(a===null||a===void 0?void 0:a.lastModified)&&(i["If-Modified-Since"]=a.lastModified);s.label=3;case 3:s.trys.push([3,8,,9]);console.log("Fetching latest version for ".concat(e,"..."));return[4,(0,m.default)("https://registry.npmjs.org/".concat(e,"/latest"),{headers:i})];case 4:u=s.sent();if(u.status===304&&o)return[2,(console.log("Cache is still valid for ".concat(e,": ").concat(o.version)),o.version)];if(!u.ok)throw new Error("Failed to fetch latest version: ".concat(u.statusText));return[4,u.json()];case 5:l=s.sent().version;return[4,D.set(r,{version:l,timestamp:Date.now()})];case 6:s.sent();return[4,D.set(n,{etag:u.headers.get("ETag")||void 0,lastModified:u.headers.get("Last-Modified")||void 0})];case 7:return[2,(s.sent(),console.log("Cached latest version for ".concat(e,": ").concat(l)),l)];case 8:f=s.sent();if(console.error("Error fetching latest version for ".concat(e,": ").concat(f.message)),o)return[2,(console.warn("Falling back to cached version for ".concat(e,": ").concat(o.version)),o.version)];throw f;case 9:return[2]}})});return W.apply(this,arguments)}function z(e){return O.default.join(k.default.cwd(),"node_modules",e,"package.json")}function H(){return O.default.join(k.default.cwd(),"package.json")}function K(e){return Q.apply(this,arguments)}function Q(){Q=t(function(e){var t,r,n,o,a;var c=arguments;return s(this,function(s){switch(s.label){case 0:t=c.length>1&&c[1]!==void 0?c[1]:!0;s.label=1;case 1:s.trys.push([1,3,,4]);r=z(e);if(!w.default.existsSync(r))return[2,(console.log("".concat(e," is not installed.")),!0)];n=JSON.parse(w.default.readFileSync(r,"utf-8")).version;return[4,B(e,t)];case 2:o=s.sent();return[2,(console.log("Installed version of ".concat(e,": ").concat(n)),console.log("Latest version of ".concat(e,": ").concat(o)),n!==o)];case 3:a=s.sent();return[2,(console.warn("Failed to check version for ".concat(e,": ").concat(a.message)),!0)];case 4:return[2]}})});return Q.apply(this,arguments)}function R(e){return X.apply(this,arguments)}function X(){X=t(function(e){var t,o,c,i;return s(this,function(s){switch(s.label){case 0:s.trys.push([0,4,,5]);return[4,B(e,!0)];case 1:t=s.sent(),o=H(),c=JSON.parse(w.default.readFileSync(o,"utf-8"));c.dependencies=a(n({},c.dependencies),r({},e,t)),w.default.writeFileSync(o,JSON.stringify(c,null,2)),console.log("Updated ".concat(e," to version ").concat(t));return[4,$("npm i -f","Installing all dependencies with updated ".concat(e,"..."))];case 2:s.sent();return[4,$("npm run lint:fix","Fixing lint issues for ".concat(e,"..."))];case 3:s.sent(),console.log("".concat(e," updated successfully."));return[3,5];case 4:i=s.sent();throw console.error("Failed to update ".concat(e,": ").concat(i.message)),i;case 5:return[2]}})});return X.apply(this,arguments)}0&&(module.exports={getLatestPackageVersion:getLatestPackageVersion,isPackageOutdated:isPackageOutdated,updatePackage:updatePackage});