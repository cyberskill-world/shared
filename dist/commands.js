#!/usr/bin/env node
function e(e,n){if(n==null||n>e.length)n=e.length;for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function n(n){if(Array.isArray(n))return e(n)}function t(e,n,t,r,o,s,c){try{var i=e[s](c);var a=i.value}catch(e){t(e);return}if(i.done){n(a)}else{Promise.resolve(a).then(r,o)}}function r(e){return function(){var n=this,r=arguments;return new Promise(function(o,s){var c=e.apply(n,r);function i(e){t(c,o,s,i,a,"next",e)}function a(e){t(c,o,s,i,a,"throw",e)}i(undefined)})}}function o(e,n,t){if(n in e){Object.defineProperty(e,n,{value:t,enumerable:true,configurable:true,writable:true})}else{e[n]=t}return e}function s(e){if(typeof Symbol!=="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};var r=Object.keys(t);if(typeof Object.getOwnPropertySymbols==="function"){r=r.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))}r.forEach(function(n){o(e,n,t[n])})}return e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);if(n){r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})}t.push.apply(t,r)}return t}function u(e,n){n=n!=null?n:{};if(Object.getOwnPropertyDescriptors){Object.defineProperties(e,Object.getOwnPropertyDescriptors(n))}else{a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e){return n(e)||s(e)||p(e)||c()}function f(e){"@swc/helpers - typeof";return e&&typeof Symbol!=="undefined"&&e.constructor===Symbol?"symbol":typeof e}function p(n,t){if(!n)return;if(typeof n==="string")return e(n,t);var r=Object.prototype.toString.call(n).slice(8,-1);if(r==="Object"&&n.constructor)r=n.constructor.name;if(r==="Map"||r==="Set")return Array.from(r);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(n,t)}function h(e,n){var t,r,o,s,c={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function i(e){return function(n){return a([e,n])}}function a(s){if(t)throw new TypeError("Generator is already executing.");while(c)try{if(t=1,r&&(o=s[0]&2?r["return"]:s[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,s[1])).done)return o;if(r=0,o)s=[s[0]&2,o.value];switch(s[0]){case 0:case 1:o=s;break;case 4:c.label++;return{value:s[1],done:false};case 5:c.label++;r=s[1];s=[0];continue;case 7:s=c.ops.pop();c.trys.pop();continue;default:if(!(o=c.trys,o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){c=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){c.label=s[1];break}if(s[0]===6&&c.label<o[1]){c.label=o[1];o=s;break}if(o&&c.label<o[2]){c.label=o[2];c.ops.push(s);break}if(o[2])c.ops.pop();c.trys.pop();continue}s=n.call(e,c)}catch(e){s=[6,e];r=0}finally{t=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}}import*as g from"node:fs";import*as d from"node:path";import y from"node:process";import{hideBin as m}from"yargs/helpers";import v from"yargs/yargs";import{dirname as b}from"node:path";import S from"node:process";import{fileURLToPath as w}from"node:url";var _=w(import.meta.url),O=b(_),T=S.env.INIT_CWD||S.cwd();import I from"boxen";import k from"chalk";var E=k.green,A=k.yellow,P=k.red,j=k.gray,N=k.bold,x=k.blue,C={step:function(e,n,t){var r=new Date().toLocaleTimeString(),o=e!==null&&n!==null?"STEP [".concat(e,"/").concat(n,"]"):"STEP";console.log("".concat(E(o)," ").concat(j("[".concat(r,"]"))," ").concat(N(t)))},success:function(e){console.log("".concat(E("✔ SUCCESS")," ").concat(e))},error:function(e){console.log("".concat(P("✖ ERROR")," ").concat(e))},warning:function(e){console.log("".concat(A("⚠ WARNING")," ").concat(e))},info:function(e){console.log("".concat(j("ℹ INFO")," ").concat(e))},boxedResult:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:E;console.log(I(N(t("".concat(e,"\n").concat(n))),{padding:1,margin:1,borderStyle:"round",borderColor:t===P?"red":t===A?"yellow":"green"}))},logResults:function(e,n,t,r){e.length&&(e.forEach(function(e){var r=e.file,o=e.position,s=e.rule,c=e.message;console.log("".concat(n("".concat(t," File:"))," ").concat(x("".concat(r).concat(o?":".concat(o):"")))),s&&console.log("   ".concat(n("Rule:")," ").concat(n(s))),console.log("   ".concat(n("Message:")," ").concat(n(c)))}),console.log(I(N(n("".concat(t," Total ").concat(r,": ").concat(e.length))),{padding:1,margin:1,borderStyle:"round",borderColor:n===P?"red":n===A?"yellow":"green"})),console.log(j("─".repeat(40))))},displayResults:/*#__PURE__*/r(function(){var e,n,t;return h(this,function(r){switch(r.label){case 0:return[4,$()];case 1:e=r.sent(),n=e.filter(function(e){return e.type==="error"}),t=e.filter(function(e){return e.type==="warning"});!n.length&&!t.length?C.boxedResult("✔ NO ISSUES FOUND","",E):(C.logResults(t,A,"⚠","Warnings"),C.logResults(n,P,"✖","Errors"));return[2]}})})};import G from"localforage";import M from"node-persist";import F from"node:os";import H from"node:path";import R from"node:process";var L=(typeof window==="undefined"?"undefined":f(window))<"u",U=R.env.CYBERSKILL_STORAGE_DIR||H.join(F.homedir(),".cyberskill-storage");function D(){return K.apply(this,arguments)}function K(){K=r(function(){var e;return h(this,function(n){switch(n.label){case 0:e=!L&&!M.defaultInstance;if(!e)return[3,2];return[4,M.init({dir:U,stringify:JSON.stringify,parse:JSON.parse,encoding:"utf8",logging:!1,forgiveParseErrors:!0})];case 1:e=n.sent();n.label=2;case 2:e;return[2]}})});return K.apply(this,arguments)}var J={get:function e(e){return r(function(){var n,t,r;return h(this,function(o){switch(o.label){case 0:o.trys.push([0,6,,7]);if(!L)return[3,2];return[4,G.getItem(e)];case 1:t=o.sent();return[3,5];case 2:return[4,D()];case 3:o.sent();return[4,M.getItem(e)];case 4:t=(n=o.sent())!==null&&n!==void 0?n:null;o.label=5;case 5:return[2,t];case 6:r=o.sent();return[2,(console.error('❌ [Storage:get] Error getting key "'.concat(e,'":'),r),null)];case 7:return[2]}})})()},set:function e(e,n){return r(function(){var t,r;return h(this,function(o){switch(o.label){case 0:o.trys.push([0,6,,7]);if(!L)return[3,2];return[4,G.setItem(e,n)];case 1:t=o.sent();return[3,5];case 2:return[4,D()];case 3:o.sent();return[4,M.setItem(e,n)];case 4:t=o.sent();o.label=5;case 5:t;return[3,7];case 6:r=o.sent();console.error('❌ [Storage:set] Error setting key "'.concat(e,'":'),r);return[3,7];case 7:return[2]}})})()},remove:function e(e){return r(function(){var n,t;return h(this,function(r){switch(r.label){case 0:r.trys.push([0,6,,7]);if(!L)return[3,2];return[4,G.removeItem(e)];case 1:n=r.sent();return[3,5];case 2:return[4,D()];case 3:r.sent();return[4,M.removeItem(e)];case 4:n=r.sent();r.label=5;case 5:n;return[3,7];case 6:t=r.sent();console.error('❌ [Storage:remove] Error removing key "'.concat(e,'":'),t);return[3,7];case 7:return[2]}})})()},keys:function e(){return r(function(){var e,n,t;return h(this,function(r){switch(r.label){case 0:r.trys.push([0,5,,6]);if(!L)return[3,2];return[4,G.keys()];case 1:return[2,(e=r.sent())!==null&&e!==void 0?e:[]];case 2:return[4,D()];case 3:r.sent();return[4,M.keys()];case 4:n=r.sent();return[2,Array.isArray(n)?n:(console.warn("⚠️ [Storage:keys] Invalid keys response:",n),[])];case 5:t=r.sent();return[2,(console.error("❌ [Storage:keys] Error getting keys:",t),[])];case 6:return[2]}})})()},getLogLink:function e(e){return r(function(){return h(this,function(n){try{return[2,"".concat(U," (key: ").concat(e,")")]}catch(e){return[2,(console.error("❌ [Storage:getLogLink] Error getting log link:",e),null)]}return[2]})})()}};var W=function(e){return"error_list:".concat(e)};function B(e){return Y.apply(this,arguments)}function Y(){Y=r(function(e){var n,t,r,o;return h(this,function(s){switch(s.label){case 0:if(!e.length)return[2];n=Date.now(),t=W(n);s.label=1;case 1:s.trys.push([1,4,,5]);return[4,J.set(t,{errors:e,timestamp:n})];case 2:s.sent();return[4,J.getLogLink(t)];case 3:r=s.sent();r&&C.info("Open the error list manually: ".concat(r));return[3,5];case 4:o=s.sent();C.error("Failed to save errors: ".concat(o.message));return[3,5];case 5:return[2]}})});return Y.apply(this,arguments)}function $(){return q.apply(this,arguments)}function q(){q=r(function(){var e,n,t,r,o,s,c,i,a,u,f,p,g;return h(this,function(h){switch(h.label){case 0:h.trys.push([0,10,,11]);return[4,J.keys()];case 1:e=h.sent();if(!Array.isArray(e))return[2,(C.warning("Invalid response from storage.keys(): ".concat(e)),[])];n=e.filter(function(e){var n;return e===null||e===void 0?void 0:(n=e.startsWith)===null||n===void 0?void 0:n.call(e,"error_list:")}),t=[];r=true,o=false,s=undefined;h.label=2;case 2:h.trys.push([2,7,8,9]);c=n[Symbol.iterator]();h.label=3;case 3:if(!!(r=(i=c.next()).done))return[3,6];a=i.value;return[4,J.get(a)];case 4:f=h.sent();f&&(u=t).push.apply(u,l(f.errors));h.label=5;case 5:r=true;return[3,3];case 6:return[3,9];case 7:p=h.sent();o=true;s=p;return[3,9];case 8:try{if(!r&&c.return!=null){c.return()}}finally{if(o){throw s}}return[7];case 9:return[2,t];case 10:g=h.sent();return[2,(C.error("Failed to retrieve stored errors: ".concat(g.message)),[])];case 11:return[2]}})});return q.apply(this,arguments)}function z(){return Q.apply(this,arguments)}function Q(){Q=r(function(){var e,n,t,r,o,s,c,i,a,u;return h(this,function(l){switch(l.label){case 0:l.trys.push([0,10,,11]);return[4,J.keys()];case 1:e=l.sent();if(!Array.isArray(e)){C.warning("Invalid response from storage.keys(): ".concat(e));return[2]}n=e.filter(function(e){var n;return e===null||e===void 0?void 0:(n=e.startsWith)===null||n===void 0?void 0:n.call(e,"error_list:")});t=true,r=false,o=undefined;l.label=2;case 2:l.trys.push([2,7,8,9]);s=n[Symbol.iterator]();l.label=3;case 3:if(!!(t=(c=s.next()).done))return[3,6];i=c.value;return[4,J.remove(i)];case 4:l.sent(),C.success("Removed error list: ".concat(i));l.label=5;case 5:t=true;return[3,3];case 6:return[3,9];case 7:a=l.sent();r=true;o=a;return[3,9];case 8:try{if(!t&&s.return!=null){s.return()}}finally{if(r){throw o}}return[7];case 9:return[3,11];case 10:u=l.sent();C.error("Failed to clear error lists: ".concat(u.message));return[3,11];case 11:return[2]}})});return Q.apply(this,arguments)}import{exec as V}from"node:child_process";import X from"node:process";import*as Z from"node:util";var ee=Z.promisify(V),en=X.env.DEBUG==="true",et=/^\s*(\d+):(\d+)\s+(error|warning)\s+(\S+)\s+(\S+)$/,er=/^(.+?)\((\d+),(\d+)\):\s+(error|warning)\s+TS\d+:\s+(\S.+)$/,eo=/^✖\s+(.*?)\s+\[(.*?)\]$/;function es(e){var n=[],t=[],r="";e.split("\n").forEach(function(e){if(e.startsWith("/"))r=e.trim();else{var o=et.exec(e)||[],s=er.exec(e)||[],c=eo.exec(e)||[];o.length&&r?n.push({file:r,position:"".concat(o[1],":").concat(o[2]),type:o[3]==="error"?"error":"warning",message:o[4].trim(),rule:o[5].trim()}):s.length?n.push({file:s[1],position:"".concat(s[2],":").concat(s[3]),type:s[4]==="error"?"error":"warning",message:s[5].trim()}):c.length?n.push({file:"commitlint",type:"error",message:c[1].trim(),rule:c[2].trim()}):t.push(e.trim())}}),n.length&&B(n),t.length&&en&&(C.warning("Unmatched lines:"),t.forEach(function(e){return console.log("  ".concat(e))}))}function ec(e){try{var n=JSON.parse(e),t=[];n.forEach(function(e){var n=e.filePath,r=e.messages;r.forEach(function(e){var r=e.severity,o=e.line,s=e.column,c=e.ruleId,i=e.message;t.push({type:r===2?"error":"warning",file:n,position:"".concat(o,":").concat(s),rule:c,message:i})})}),t.length&&B(t)}catch(n){es(e)}}function ei(e){return ea.apply(this,arguments)}function ea(){ea=r(function(e){var n,t,r,o,s,c,i,a,u;var l=arguments;return h(this,function(f){switch(f.label){case 0:n=l.length>1&&l[1]!==void 0?l[1]:ec;t=new AbortController;X.on("SIGINT",function(){C.warning("Process interrupted. Terminating..."),t.abort(),X.exit()});f.label=1;case 1:f.trys.push([1,3,,4]);return[4,ee(e,{maxBuffer:0x6400000,signal:t.signal})];case 2:r=f.sent(),o=r.stdout,s=r.stderr;[o,s].forEach(function(e){return e&&n(e)});return[3,4];case 3:c=f.sent();i=c.stdout,a=c.stderr,u=c.message;[i,a].forEach(function(e){return e&&n(e)}),!a&&!i&&C.error("Command failed: ".concat(u));return[3,4];case 4:return[2]}})});return ea.apply(this,arguments)}import eu from"node-fetch";import el from"node:fs";import ef from"node:path";var ep=24*60*60*1e3;function eh(e){return e?ef.join(T,"node_modules",e,"package.json"):ef.join(T,"package.json")}function eg(e){return ed.apply(this,arguments)}function ed(){ed=r(function(e){var n,t,r,o,s,c,i,a,u,l;var f=arguments;return h(this,function(p){switch(p.label){case 0:n=f.length>1&&f[1]!==void 0?f[1]:!1;t="npm_version:".concat(e),r="npm_metadata:".concat(e);return[4,J.get(t)];case 1:o=p.sent();return[4,J.get(r)];case 2:s=p.sent(),c=o&&Date.now()-o.timestamp<ep;if(!n&&c)return[2,(C.info("Using cached version for ".concat(e,": ").concat(o.version)),o.version)];i={};(s===null||s===void 0?void 0:s.etag)&&(i["If-None-Match"]=s.etag),(s===null||s===void 0?void 0:s.lastModified)&&(i["If-Modified-Since"]=s.lastModified);p.label=3;case 3:p.trys.push([3,8,,9]);C.info("Fetching latest version for ".concat(e,"..."));return[4,eu("https://registry.npmjs.org/".concat(e,"/latest"),{headers:i})];case 4:a=p.sent();if(a.status===304&&o)return[2,(C.info("Cache is still valid for ".concat(e,": ").concat(o.version)),o.version)];if(!a.ok)throw new Error("Failed to fetch latest version: ".concat(a.statusText));return[4,a.json()];case 5:u=p.sent().version;return[4,J.set(t,{version:u,timestamp:Date.now()})];case 6:p.sent();return[4,J.set(r,{etag:a.headers.get("ETag")||void 0,lastModified:a.headers.get("Last-Modified")||void 0})];case 7:return[2,(p.sent(),C.success("Cached latest version for ".concat(e,": ").concat(u)),u)];case 8:l=p.sent();if(C.error("Error fetching latest version for ".concat(e,": ").concat(l.message)),o)return[2,(C.warning("Falling back to cached version for ".concat(e,": ").concat(o.version)),o.version)];throw l;case 9:return[2]}})});return ed.apply(this,arguments)}function ey(e){return em.apply(this,arguments)}function em(){em=r(function(e){var n,t,r,o,s;var c=arguments;return h(this,function(i){switch(i.label){case 0:n=c.length>1&&c[1]!==void 0?c[1]:!0;i.label=1;case 1:i.trys.push([1,3,,4]);t=eh(e);if(!el.existsSync(t))return[2,(C.info("".concat(e," is not installed.")),!0)];r=JSON.parse(el.readFileSync(t,"utf-8")).version;return[4,eg(e,n)];case 2:o=i.sent();return[2,(C.info("Installed version of ".concat(e,": ").concat(r)),C.info("Latest version of ".concat(e,": ").concat(o)),r!==o)];case 3:s=i.sent();return[2,(C.warning("Failed to check version for ".concat(e,": ").concat(s.message)),!0)];case 4:return[2]}})});return em.apply(this,arguments)}function ev(e){return eb.apply(this,arguments)}function eb(){eb=r(function(e){var n,t,r,s;return h(this,function(c){switch(c.label){case 0:c.trys.push([0,4,,5]);return[4,eg(e,!0)];case 1:n=c.sent(),t=eh();if(!el.existsSync(t)){C.error("package.json not found. Cannot update ".concat(e));return[2]}r=JSON.parse(el.readFileSync(t,"utf-8"));r.dependencies=u(i({},r.dependencies),o({},e,n)),el.writeFileSync(t,JSON.stringify(r,null,2)),C.info("Updated ".concat(e," to version ").concat(n));return[4,ei("npm i -f")];case 2:c.sent();return[4,ei("npm run lint:fix")];case 3:c.sent(),C.success("".concat(e," updated successfully."));return[3,5];case 4:s=c.sent();throw C.error("Failed to update ".concat(e,": ").concat(s.message)),s;case 5:return[2]}})});return eb.apply(this,arguments)}function eS(e,n){try{var t=ef.join(e,"package.json");return el.existsSync(t)?JSON.parse(el.readFileSync(t,"utf-8")).name===n:!1}catch(e){return C.error("Error reading package.json: ".concat(e.message)),!1}}var ew={TS_CONFIG_PATH:d.join(T,"tsconfig.json"),HUSKY_PATH:d.join(T,".husky"),GIT_HOOK_PATH:d.join(T,".git","hooks"),GIT_COMMIT_MSG:d.join(T,".git","COMMIT_EDITMSG"),SIMPLE_GIT_HOOKS_PATH:d.join(T,".simple-git-hooks.json"),PACKAGE_NAME:"@cyberskill/shared",LINT_STAGED_CONFIG_PATH:d.resolve(O,"./configs/lint-staged/base.js"),COMMITLINT_CONFIG_PATH:d.resolve(O,"./configs/commitlint/base.js"),UNIT_TEST_CONFIG_PATH:d.resolve(O,"./configs/vitest/react/unit.js"),E2E_TEST_CONFIG_PATH:d.resolve(O,"./configs/vitest/react/e2e.js")},e_=function(e){return g.existsSync(e)};function eO(){return eT.apply(this,arguments)}function eT(){eT=r(function(){var e;return h(this,function(n){switch(n.label){case 0:C.step(1,2,"Starting TypeScript check");if(!e_(ew.TS_CONFIG_PATH))return[3,2];return[4,ei("npx tsc -p ".concat(ew.TS_CONFIG_PATH," --noEmit"))];case 1:e=n.sent();return[3,3];case 2:e=C.warning("tsconfig.json file not found. Skipping TypeScript check.");n.label=3;case 3:e;return[2]}})});return eT.apply(this,arguments)}function eI(){return ek.apply(this,arguments)}function ek(){ek=r(function(){var e,n;var t=arguments;return h(this,function(r){switch(r.label){case 0:e=t.length>0&&t[0]!==void 0?t[0]:!1;C.step(2,2,"Starting ESLint ".concat(e?"fix":"check"));n="npx eslint ".concat(T).concat(e?" --fix":"");return[4,ei(n)];case 1:r.sent();return[2]}})});return ek.apply(this,arguments)}function eE(){return eA.apply(this,arguments)}function eA(){eA=r(function(){return h(this,function(e){switch(e.label){case 0:C.step(null,null,"Starting lint-staged process");return[4,ei("npx lint-staged --config ".concat(ew.LINT_STAGED_CONFIG_PATH))];case 1:e.sent();return[2]}})});return eA.apply(this,arguments)}function eP(){return ej.apply(this,arguments)}function ej(){ej=r(function(){return h(this,function(e){switch(e.label){case 0:C.step(null,null,"Inspecting lint rules");return[4,ei("npx @eslint/config-inspector")];case 1:e.sent();return[2]}})});return ej.apply(this,arguments)}function eN(){return ex.apply(this,arguments)}function ex(){ex=r(function(){return h(this,function(e){switch(e.label){case 0:C.step(null,null,"Starting full lint check");return[4,z()];case 1:e.sent();return[4,Promise.all([eO(),eI()])];case 2:e.sent();return[4,C.displayResults()];case 3:e.sent();return[2]}})});return ex.apply(this,arguments)}function eC(){return eG.apply(this,arguments)}function eG(){eG=r(function(){return h(this,function(e){switch(e.label){case 0:C.step(null,null,"Running commit lint");return[4,ei("npx --no -- commitlint --edit ".concat(ew.GIT_COMMIT_MSG," --config ").concat(ew.COMMITLINT_CONFIG_PATH))];case 1:e.sent();return[2]}})});return eG.apply(this,arguments)}function eM(){return eF.apply(this,arguments)}function eF(){eF=r(function(){var e,n;return h(this,function(t){switch(t.label){case 0:C.step(2,2,"Setting up Git hooks");e=e_(ew.HUSKY_PATH);if(!e)return[3,2];return[4,ei("npx rimraf ".concat(ew.HUSKY_PATH," ").concat(ew.GIT_HOOK_PATH," && git config core.hooksPath ").concat(ew.GIT_HOOK_PATH))];case 1:e=t.sent();t.label=2;case 2:e;n={"pre-commit":"".concat(eS(T,ew.PACKAGE_NAME)?"npm run build && ":"","npx --yes cyberskill lint-staged"),"commit-msg":"npx --yes cyberskill commitlint"};g.writeFileSync(ew.SIMPLE_GIT_HOOKS_PATH,JSON.stringify(n,null,4));return[4,ei("npx simple-git-hooks")];case 3:t.sent(),C.success("Git hooks configured successfully."),g.unlinkSync(ew.SIMPLE_GIT_HOOKS_PATH);return[2]}})});return eF.apply(this,arguments)}function eH(){return eR.apply(this,arguments)}function eR(){eR=r(function(){var e,n,t,r,o,s,c;return h(this,function(i){switch(i.label){case 0:C.step(1,2,"Starting project setup");e=d.join(T,"package.json");i.label=1;case 1:i.trys.push([1,10,,11]);if(!e_(e)){C.error("package.json not found. Setup aborted.");return[2]}t=JSON.parse(g.readFileSync(e,"utf-8"));if(!eS(T,ew.PACKAGE_NAME))return[3,2];r=C.success("Cyberskill is already installed.");return[3,8];case 2:s=!((n=t.dependencies)===null||n===void 0?void 0:n[ew.PACKAGE_NAME]);if(s)return[3,4];return[4,ey(ew.PACKAGE_NAME)];case 3:s=i.sent();i.label=4;case 4:if(!s)return[3,6];C.info("Updating Cyberskill package...");return[4,ev(ew.PACKAGE_NAME)];case 5:o=i.sent();return[3,7];case 6:o=C.success("Cyberskill is up to date.");i.label=7;case 7:r=o;i.label=8;case 8:r;return[4,eM()];case 9:i.sent();return[3,11];case 10:c=i.sent();throw C.error("Error reading package.json: ".concat(c.message)),c;case 11:return[2]}})});return eR.apply(this,arguments)}function eL(){return eU.apply(this,arguments)}function eU(){eU=r(function(){return h(this,function(e){switch(e.label){case 0:C.step(null,null,"Running unit tests");return[4,ei("npx vitest --config ".concat(ew.UNIT_TEST_CONFIG_PATH))];case 1:e.sent();return[2]}})});return eU.apply(this,arguments)}function eD(){return eK.apply(this,arguments)}function eK(){eK=r(function(){return h(this,function(e){switch(e.label){case 0:C.step(null,null,"Running e2e tests");return[4,ei("npx vitest --config ".concat(ew.E2E_TEST_CONFIG_PATH))];case 1:e.sent();return[2]}})});return eK.apply(this,arguments)}v(m(y.argv)).command("lint","Run linting checks",eN).command("lint:fix","Fix linting issues",function(){return eI(!0)}).command("lint:inspect","Inspect linting rules",eP).command("lint-staged","Run lint-staged",eE).command("commitlint","Run commitlint",eC).command("setup","Run project setup",eH).command("reset","Reset project dependencies",/*#__PURE__*/r(function(){return h(this,function(e){switch(e.label){case 0:C.step(null,null,"Starting project reset");return[4,ei("npx rimraf ".concat(T,"/node_modules ").concat(T,"/package-lock.json"))];case 1:e.sent();return[4,ei("npm install")];case 2:e.sent();return[4,eM()];case 3:e.sent();return[2]}})})).command("test:unit","Run unit tests",eL).command("test:e2e","Run e2e tests",eD).help().parse();